{%extends 'layout.template.html' %}

{%block content%}

<br>
<div class="container text-center">
    <h2>{{liquor.name}}</h2>
</div>
<br>

<div class="container-fluid row">

    <div class="col-lg-6"> 
        <input type="hidden" id="uploaded_file_url" name="uploaded_file_url"/>
        <img src="{{liquor.uploaded_file_url}}" id="uploaded-image" class="mx-auto d-block liquor-image" alt="liquor image">
    </div>

    <div class="col-lg-6">
        <div class="container">
            <label>Liquor type:</label> {{liquor.type}}
        </div>

        <div class="container">
            <label>Primary alcohol:</label> {{liquor.primary_alcohol}}
        </div>

        <div class="container">
            <label>Serving method:</label> {{liquor.serving_method}}
        </div>

        <div class="container">
            <label>Standard drinkware:</label> {{liquor.standard_drinkware}}
        </div>

        <div class="container">
            <label>Ingredients:</label> 
            <br>
            <textarea readonly rows="3" class="form-control">{{liquor.ingredients}}</textarea>
        </div>

        <div class="container">
            <label>Preparation:</label> 
            <br>
            <textarea readonly rows="3" class="form-control">{{liquor.preparation}}</textarea>
        </div>
    </div>
</div>

<br>

<div class="container text-center">
    <a href="{{url_for('update_liquor', id=liquor._id)}}" class="btn btn-primary btn-sm">Edit</a>
    <a href="{{url_for('delete_liquor', id=liquor._id)}}" class="btn btn-danger btn-sm">Delete</a>
    <a href="{{url_for('create_reviews', id=liquor._id)}}" class="btn btn-primary btn-sm">Add Reviews</a>
</div>

<br>

<div class="container text-center">
    <h2>Reviews</h2>
</div>

<div class="reviews-list">
    {%for r in liquor.reviews%}
    <br>
    <div class="container-fluid row review-box">
        <div class="container col-lg-10">
            {{r.username}}
            <br>  
            {{r.date}}
            <br>
            Review: {{r.review}}
        </div>
        <div class="container col-lg-2">
            <a href="{{url_for('edit_reviews', review_id= r._id)}}" class="btn btn-primary btn-sm">Edit</a> 
            <a href="{{url_for('confirm_delete_review', review_id=r._id)}}" class="btn btn-danger btn-sm">Delete</a>
        </div>    
    </div>
    {%endfor%}
</div>
<br>
{%endblock%}

{%block js %}
	<script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>

	<script type="text/javascript">
		var myWidget = cloudinary.createUploadWidget({
            cloudName: '{{cloud_name}}', 
            uploadPreset: '{{upload_preset}}'}, (error, result) => { 
                if (!error && result && result.event === "success") { 
                    console.log('Done! Here is the image info: ', result.info); 
                    let fileURL = document.querySelector('#uploaded_file_url');
                    fileURL.value = result.info.url;

                    document.querySelector('#uploaded-image').src = result.info.url
                }
            }
        )

        document.getElementById("upload_widget").addEventListener("click", function(){
                myWidget.open();
        }, false);
	</script>
{%endblock%}