{%extends 'layout.template.html' %}

{%block content%}
<h2>Add new liquor</h2>
<form method="POST">
    <div class="form-group">
        <label>Liquor name:</label>
        <input type="text" class="form-control" name="liquor_name"/>
    </div>

    <div class="form-group">
        <label>Liquor type:</label>
        <input type="text" class="form-control" name="liquor_type"/>
    </div>

    <div class="form-group">
        <label>Primary alcohol:</label>
        <input type="text" class="form-control" name="primary_alcohol"/>
    </div>

    <div class="form-group">
        <label>Serving method:</label>
        <input type="text" class="form-control" name="serving_method"/>
    </div>

    <div class="form-group">
        <label>Standard drinkware:</label>
        <input type="text" class="form-control" name="standard_drinkware"/>
    </div>

    <div>
        <label>Ingredients:</label>
        <input type="text" name="ingredients" class="form-control"/>
    </div>

    <div>
        <label>Preparation:</label>
        <input type="text" name="preparation" class="form-control"/>
    </div>

    <br>

    <div>
        <a id="upload_widget" class="cloudinary-button">Upload files</a>
        <input type="hidden" id="uploaded_file_url" name="uploaded_file_url"/>
        <br/>
        <p id="uploaded_file_display" style="display:none">Uploaded File Name:<span id="uploaded_file_name"></span></p>
    </div>

    <br>

    <input type="submit" class="btn btn-primary"/>

</form>
{%endblock%}

{%block js %}
	<script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>

	<script type="text/javascript">
		var myWidget = cloudinary.createUploadWidget({
            cloudName: '{{cloud_name}}', 
            uploadPreset: '{{upload_preset}}'}, (error, result) => { 
                if (!error && result && result.event === "success") { 
                    console.log('Done! Here is the image info: ', result.info); 
                    let fileURL = document.querySelector('#uploaded_file_url');
                    fileURL.value = result.info.url;

                    let filenameDisplay = document.querySelector('#uploaded_file_display');

                    // make it appear (by setting it to display: block)
                    filenameDisplay.style.display = 'block';

                    // fill in the file name
                    let filenameDisplaySpan = document.querySelector("#uploaded_file_name");
                    filenameDisplaySpan.innerText = result.info.original_filename;
                }
            }
        )

        document.getElementById("upload_widget").addEventListener("click", function(){
                myWidget.open();
        }, false);
	</script>
{%endblock%}
